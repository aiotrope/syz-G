import{r as l,_,u as w,k as f,b as d,j as e}from"./index-94fca464.js";import{c as A,a as m,u as F,b as T,o as k}from"./yup-3e96ae65.js";import{b as n}from"./browser-993d398e.js";import{o as D}from"./jwt-decode.esm-9c18df67.js";import{S as I}from"./Stack-046467dd.js";import{Q as g}from"./App-ff4ff5eb.js";import{p as h,b as j,a as O}from"./post-039f65a6.js";import{j as $}from"./auth-89fb04be.js";import{p,u as y}from"./queryKeyFactory-17eee966.js";const M=l.lazy(()=>_(()=>import("./createForm-e32a1a76.js"),["assets/createForm-e32a1a76.js","assets/index-94fca464.js","assets/index-61b77ebf.css","assets/Form-01d6657c.js","assets/App-ff4ff5eb.js","assets/App-36b8f6be.css","assets/index-090fa6c0.js","assets/createWithBsPrefix-2e1af6a5.js","assets/Col-8e5ef79d.js","assets/Button-cc906282.js","assets/Button-0a6dc675.js","assets/Row-e15797d1.js"])),N=l.lazy(()=>_(()=>import("./created-16d2d615.js"),["assets/created-16d2d615.js","assets/index-94fca464.js","assets/index-61b77ebf.css","assets/App-ff4ff5eb.js","assets/App-36b8f6be.css","assets/Row-e15797d1.js","assets/Col-8e5ef79d.js","assets/Badge-e5f34967.js","assets/index-a9f93b6b.js","assets/index-090fa6c0.js","assets/highlighter-ba78fcc7.js","assets/objectWithoutPropertiesLoose-6c5c234b.js"])),B=l.lazy(()=>_(()=>import("./loader-a290854d.js"),["assets/loader-a290854d.js","assets/index-94fca464.js","assets/index-61b77ebf.css","assets/App-ff4ff5eb.js","assets/App-36b8f6be.css"])),G=A({title:m().min(5).required(),description:m().min(10).required(),entry:m().min(10).required()}).required(),se=()=>{const[r,c]=l.useState([]),o=w(),v=f(h),q=f(j),S=d(h),a=d(j),b=d($),z=D(b),u=F({mutationFn:O.createPost,onSuccess:()=>{o.invalidateQueries({queryKey:p.details()}),o.invalidateQueries({queryKey:p.lists()}),o.invalidateQueries({queryKey:y.details()}),o.invalidateQueries({queryKey:y.lists()}),o.invalidateQueries({queryKey:y.detail(z.id)}),o.invalidateQueries({queryKey:p.detail(a==null?void 0:a.id)})}}),{register:C,handleSubmit:E,reset:x,getValues:K,formState:{errors:Q}}=T({resolver:k(G),mode:"all"}),L=t=>{t.preventDefault();const s=K("lang");c(i=>[...i,n.sanitize(s.toLowerCase())]),console.log("Tag",r)},P=()=>{c([]),x()},R=async t=>{try{const s={title:n.sanitize(t.title),description:n.sanitize(t.description),tag:r,entry:n.sanitize(t.entry)},i=await u.mutateAsync(s);i&&(g.success(i.message,{theme:"colored"}),q(i.post),v(S.concat(i.post)),c([]),x())}catch(s){g.error(s.response.data.error,{theme:"colored"})}},V=r==null?void 0:r.map((t,s)=>e.jsx("small",{children:e.jsx("span",{className:"bg-light m-1 text-danger",children:t})},s));return u.isLoading?e.jsx(B,{}):e.jsxs(I,{className:"col-md-9 mx-auto",children:[e.jsx("h2",{children:"Create Snippet"}),e.jsx("p",{children:"All fields are required to fill-in."}),e.jsx(M,{handleSubmit:E,onSubmit:R,register:C,errors:Q,handleClickLang:L,resetForm:P,postMutation:u,tag:r,tagValue:V}),a.entry?e.jsx(e.Fragment,{children:e.jsx(N,{post:a})}):null]})};export{se as default};
